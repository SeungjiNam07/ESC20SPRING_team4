---
title : Imputation
author:
  name : 오태환
date: "`r Sys.Date()`"
output:
  html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 1) Importing data

```{r}
library(tidyverse)
library(mice)
data = read_csv("C:/Users/dhxog/Desktop/ESC4-1/Final_Project/FS_2y_before_Bankruptcy_train.csv")
```

# 2) Change ? to NA
```{r}
data[data == "?"] = NA

for(i in 1:ncol(data)){
  data[,i] = data[,i] %>% unlist() %>% as.numeric
}
```

# 3) NA가 많은 Attr37 제거 후 imputation 진행
```{r}
tempdata = data %>% select(-Attr37)

imp = mice(tempdata, seed = 1234)
```

```{r}
imp
```
### PMM(Predictive mean matching) 방식으로 Imputation을 진행했다.

## 4) 저장하자
```{r}
complete.data = complete(imp)


write.csv(data, "imputed_data.csv", row.names = FALSE)


```